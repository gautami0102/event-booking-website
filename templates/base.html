<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EventBook{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="dashboard-wrapper">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-logo">EventBook</div>
            <ul class="sidebar-menu">
                <li class="{{ 'active' if request.path == url_for('dashboard') else '' }}"><a href="{{ url_for('dashboard') }}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li class="{{ 'active' if request.path == url_for('my_bookings') else '' }}"><a href="{{ url_for('my_bookings') }}"><i class="fas fa-ticket-alt"></i> My Bookings</a></li>
                <li class="{{ 'active' if request.path == url_for('wishlist') else '' }}"><a href="{{ url_for('wishlist') }}"><i class="fas fa-heart"></i> Wishlist</a></li>
                <li class="{{ 'active' if request.path == url_for('wallet') else '' }}"><a href="{{ url_for('wallet') }}"><i class="fas fa-wallet"></i> Wallet/Rewards</a></li>
                <li><a href="#"><i class="fas fa-bell"></i> Notifications</a></li>
                <li class="{{ 'active' if request.path == url_for('help_support') else '' }}"><a href="{{ url_for('help_support') }}"><i class="fas fa-question-circle"></i> Help & Support</a></li>
                <li class="{{ 'active' if request.path == url_for('settings') else '' }}"><a href="{{ url_for('settings') }}"><i class="fas fa-cog"></i> Settings</a></li>
                <li><a href="/"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navigation Bar -->
            <header class="top-nav">
                <div class="greeting">
                    <h1>{% block header_title %}Hi, {{ user.name }} ðŸ‘‹{% endblock %}</h1>
                    <p>{% block header_subtitle %}Ready for your next event?{% endblock %}</p>
                </div>
                <div class="top-nav-actions">
                    <i class="fas fa-search"></i>
                    <div class="notif" id="notifBell" tabindex="0" role="button" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-bell"></i>
                        <div class="notif-dropdown">
                            <p class="notif-empty">There are no notifications</p>
                        </div>
                    </div>
                    <img src="{{ user.profile_pic }}" alt="Profile" class="top-nav-profile-pic">
                </div>
            </header>

            <!-- Main Dashboard Content -->
            <main class="dashboard-panels">
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>
    {% block scripts %}{% endblock %}
    <script>
        (function() {
            const notif = document.getElementById('notifBell');
            if (!notif) return;
            function closeDropdown() {
                notif.classList.remove('open');
                notif.setAttribute('aria-expanded', 'false');
            }
            notif.addEventListener('click', function(e) {
                e.stopPropagation();
                const isOpen = notif.classList.toggle('open');
                notif.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
            });
            document.addEventListener('click', function() {
                closeDropdown();
            });
            notif.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeDropdown();
                    notif.blur();
                } else if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    notif.click();
                }
            });
        })();
    </script>
</body>
</html>